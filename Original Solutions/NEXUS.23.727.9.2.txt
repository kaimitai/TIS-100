@0
##KAIMITAI 1ST
INIT: MOV 8,ACC
LOOP: SUB 1
MOV 0,LEFT
JEZ START
JMP LOOP
START:MOV UP,ACC
JEZ WRITE
MOV 1,DOWN
MOV UP,RIGHT
JMP START
WRITE: MOV 0,DOWN
MOV UP,DOWN
MOV UP,DOWN
JMP START

@1
MOV LEFT,ACC
START: JRO DOWN
1: JEZ OK
SUB 1
MOV -1,DOWN
JMP START
OK: SUB 1
MOV 1,DOWN
JMP START

@2
STR:MOV RIGHT,DOWN
MOV RIGHT,DOWN
MOV 8,ACC
LOOP: SAV
MOV 1,DOWN
MOV RIGHT,DOWN
MOV DOWN,RIGHT
SUB 1
JEZ END
JMP LOOP
NO:
END: MOV -99,DOWN

@3
START: MOV 8,ACC
JRO RIGHT
1: MOV RIGHT,LEFT
MOV RIGHT,LEFT
LOOP:MOV UP,LEFT
MOV LEFT,DOWN
SUB 1
JEZ START
JMP LOOP
8: MOV UP,RIGHT
MOV RIGHT,DOWN
SUB 1
JEZ START
JMP 8
13: MOV DOWN,UP

@4
START: MOV UP,ACC
JEZ READ
WT: MOV 8,LEFT
LP: MOV LEFT,ACC
MOV ACC,LEFT
MOV ACC,RIGHT
JRO DOWN
JMP END
READ: MOV 1,LEFT
MOV UP,LEFT
MOV UP,LEFT
END: MOV 8,ACC
LOOP: MOV 13,LEFT
SUB 1
JNZ LOOP

@5
STR: MOV 8,ACC
LOOP: SAV
MOV 1,UP
MOV LEFT,ACC
MOV UP,DOWN
MOV ACC,DOWN
SWP
SUB 1
JEZ END
JMP LOOP
END: MOV -99,UP

@6
MOV UP,ACC
SWP
MOV UP,ACC
SWP
START: JRO UP
1: JEZ OK
SUB 1
MOV UP,UP
JMP START
OK: SUB 1
SWP
MOV UP,NIL
MOV ACC,UP
SWP
JMP START

@7
MOV 8,ACC
LOOP: SAV
MOV RIGHT,ACC
JLZ NO
MOV ACC,DOWN
NO: SWP
SUB 1
JEZ END
MOV -3,UP
JMP LOOP

END: MOV 5,UP

@8
START:MOV UP,ACC
JLZ NO
MOV UP,LEFT
JMP START
NO:
MOV UP,NIL
MOV -1,LEFT